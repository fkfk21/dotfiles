# set -g default-terminal "screen-256color"
# set -g terminal-overrides 'xterms:colors=256' # Key bind set-window-option -g mode-keys vi bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
# bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"
# bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
# bind -T copy-mode-vi V send-keys -X select-line
# # bind -T copy-mode-vi Esc send-keys -X clear-selection
# 
# 

# クリップボードにコピー
# マウススクロールをオンにすると、マウス選択コピーがクリップボードにコピーされなくなるため
# set -s copy-command 'pbcopy' 

set -g default-terminal "tmux-256color"
set -as terminal-features 'xterm-256color:RGB'

set -gw mode-keys vi      # prefix + [ でのkey bindingsをviモードで
set -gw status-keys vi    # prefix + : でのkey bindingsをviモードで

bind b break-pane         # 現在のペインを新しいwindowに分離

#  Nybkox/tmux-kanagawa             \
#  jimeh/tmux-themepack

set -g @tpm_plugins '              \
  tmux-plugins/tpm                 \
  tmux-plugins/tmux-sensible       \
  tmux-plugins/tmux-yank           \
  tmux-plugins/tmux-resurrect      \
  tmux-plugins/tmux-continuum      \
  tmux-plugins/tmux-pain-control   \
  nhdaly/tmux-better-mouse-mode    \
  dracula/tmux                     \
  fkfk21/tmux-floating-terminal    \
'

# (tmux-yank追加設定) コピーモードでのkey bindings
bind -T copy-mode-vi v send-keys -X begin-selection     # vimのようにvで選択開始
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle  # 矩形/範囲 選択の切り替え


# (tmux-resurrect/tmux-continuum) tmux pane 自動保存設定
set -g @resurrect-capture-pane-contents 'on'            # tmux 保存時にpaneの内容も保存
set -g @continuum-restore 'on'                          # tmux 起動時に自動復元
set -g @continuum-save-interval '10'                    # tmux 保存インターバル (min)


# (tmux-better-mouse-mode) マウス 設定
set -g mouse on                                                           # mouse mode 有効化
set-option -s set-clipboard off
bind-key -T copy-mode-vi MouseDragEnd1Pane \
    send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i"     # マウス選択でのコピーをしたときにクリップボードへ
set -g @emulate-scroll-for-no-mouse-alternate-buffer 'on'                 # vim使っているときのスクロールを奪わないようにするため
set -g @scroll-speed-num-lines-per-scroll "5"                             # スクロール時の移動行数
bind M set-option -g mouse \; display-message "Mouse #{?mouse,on,off}"    # prefix + M で mouse on/off をtoggle


# (tmux-pain-control上書き設定) vim-likeな画面操作設定
bind s split-window -v          # prefix + s で水平分割
bind v split-window -h          # prefix + v で垂直分割
set-option -g @pane_resize "3"  # bind H,J,K,L での画面リサイズの変化量設定


# (dracula/tmux テーマ設定) tmuxの外観設定
set -g @dracula-show-flags true
set -g @dracula-border-contrast true
set -g @dracula-show-empty-plugins false
set -g @dracula-show-powerline true
set -g @dracula-show-edge-icons false
set -g @dracula-show-left-icon "#S"
set -g @dracula-show-right-sep  ""  
set -g @dracula-cpu-usage-colors ""
set -g @dracula-left-icon-padding 0
set -g @dracula-show-ssh-only-when-connected true
set -g @dracula-time-format "%Y/%m/%d %T %Z"
set -g @dracula-show-timezone true

set -g @dracula-time-usage-colors "cyan white"
set -g @dracula-cpu-usage-colors "dark_gray white"
set -g @dracula-gpu-ram-usage-colors "gray white"
set -g @dracula-ram-usage-colors "dark_gray white"
set -g @dracula-plugins "ssh-session cpu-usage gpu-ram-usage ram-usage time"

set -g @dracula-colors "
# simple gruvbox Color Pallette
white='#EBDBB2'
gray='#32302F'
dark_gray='#282828'
light_purple='#B16286'
dark_purple='#504945'
cyan='#689D6A'
green='#98971A'
orange='#D65D0E'
red='#CC241D'
pink='#D3869B'
yellow='#D79921'
"


# (tmux-floating-terminal keybindings設定) tmuxでのpopup windowの設定
set -g @floating_scratch_term 'i'              # prefix + i でpopup 切り替え
set -g @floating_scratch_to_active_win 'M-h'   # floating内のペインを現在のwindowの左に追加
set -g @floating_active_pane_to_scratch 'M-m'  # 現在のペインをfloating内に追加
set -g @floating_pane_rate '80'                # floatingペインの画面占有率 (%)


run-shell '~/.tmux/plugins/tpm/tpm'
